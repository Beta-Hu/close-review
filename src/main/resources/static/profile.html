<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="main">
    <div class="head ui-sortable-helper">
        <div class="divlogo">
            <img src="img/logo.png" class="logo">
        </div>
        <div class="divbutton">
            <a class="profile" href="profile.html">Profile<br></a>
            <a class="sign" id="sign"></a>
        </div>
    </div>
    <div class="bigholder"></div>
    <div class="detail">
        <span class="bigfont">Username</span>
        <span class="smallfont" id="username"></span>
        <div class="smallholder"></div>
        <span class="bigfont">Email</span>
        <span class="smallfont" id="email"></span>
        <div class="smallholder"></div>
        <span class="bigfont">Organization</span>
        <span class="smallfont" id="organization"></span>
    </div>
    <div class="bigholder"></div>
    <div class="detail">
        <span class="bigfont">Publications</span>
        <ul id="publication">

        </ul>
    </div>
</div>
</body>

<p style="background: none; height: 5%; position: fixed; bottom: 0; width: 100%; text-align: center;">
    <img style="padding-top:2px; height: 10px; width: auto" src="/img/emblem.png" alt="">
    <a id="icp" style="color:#000; font-size: 8px" href="https://beian.miit.gov.cn/" target="_blank"></a>
</p>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/user-status.js"></script>
<script type="text/javascript" src="js/bei-an.js"></script>
<script type="text/javascript">
    window.onload = function () {
        if (sessionStorage.getItem("user") == null){
            document.location.href = document.location.origin + "/signin.html";
        } else{
            $.ajax({
                type: "GET",
                url: "/user/profile",
                dataType: 'json',
                async: true,
                data: {},
                success: function (data){
                    if (data["status"] === 0){
                        document.getElementById("username").innerHTML = data["data"]["user"]["username"];
                        document.getElementById("email").innerHTML = data["data"]["user"]["email"];
                        document.getElementById("organization").innerHTML = data["data"]["user"]["organization"];

                        for (var i = 0; i < data["data"]["submissions"].length; i++)
                            document.getElementById("publication").innerHTML +=
                                "<li class=\"highitem\"> <div>" +
                                "<span><a class='listhref' href='accepted-paper.html?submissionId=" + data["data"]["submissions"][i]["id"] + "'>" +
                                data["data"]["submissions"][i]["title"] + "</a></span>" +
                                "<span class='tinyfont'>" + data["data"]["submissions"][i]["conferenceName"] + "</span>" +
                                "</div> </li> " +
                                "<div class=\"smallholder\"> </div>"
                    }
                    else
                        alert("password mismatch with email.");
                }
            });
        }

    }
</script>

</html>
