<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Conferences</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="main">
    <div class="head ui-sortable-helper">
        <div class="divlogo">
            <img src="img/logo.png" class="logo">
        </div>
        <div class="divbutton">
            <a class="profile">Profile<br></a>
            <a class="sign" id="sign"></a>
        </div>
    </div>
    <div class="bigholder"></div>
    <div class="smallholder"></div>
    <div class="horizonalbox">
        <span class="bigfont" id="conference-name"></span>
        <button type="submit" name="button" class="submitbutton" onclick="createNewSubmission()">Add</button>
    </div>
    <div>
        <ul id="submission-list">
        </ul>
    </div>
</div>
</body>

<p style="background: none; height: 5%; position: fixed; bottom: 0; width: 100%; text-align: center;">
    <img style="padding-top:2px; height: 10px; width: auto" src="/img/emblem.png" alt="">
    <a class="icp" style="color:#000; font-size: 8px" href="https://beian.miit.gov.cn/" target="_blank">鄂ICP备2023008384号</a>
</p>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/user-status.js"></script>
<script type="text/javascript">
    var conferenceId = window.location.href.split("=");
    conferenceId = conferenceId[conferenceId.length - 1];
    window.onload = function () {
        $.ajax({
            type: "GET",
            url: "/conference/active/" + conferenceId,
            dataType: 'json',
            async: true,
            data: {},
            success: function (data) {
                var status = data["status"];
                if (status === 0) {
                    for (var i = 0; i < data["data"].length; i++) {
                        document.getElementById("submission-list").innerHTML +=
                            "<li class=\"item\">" +
                            "<div class=\"horizonalbox\">" +
                            "<a class='listhref' href='" + window.location.origin + "/submission.html?conferenceId=" + conferenceId + "&submissionId=" + data["data"][i]["id"] + " '>" +
                            data["data"][i]["title"] + "</a>" +
                            "<a class=\"smallhref\">withdraw</a>" +
                            "</div>\n" +
                            "</li> <div class=\"smallholder\"> </div>"
                    }
                    document.getElementById("conference-name").innerHTML = data["data"]["conference"]["name"];
                } else {
                    alert("please sign in first");
                }
            },
            error: function () {
                alert("error occurred");
            }
        });
    };

    function createNewSubmission() {
        window.location.href = window.location.origin + "/submission.html?conferenceId=" + conferenceId + "&submissionId=0&newSubmission";
    }
</script>


</html>
